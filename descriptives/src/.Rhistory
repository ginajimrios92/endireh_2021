summarize(total=sum(fac_muj, na.rm=T))%>%
filter(!is.na(habloalg))%>%
ungroup()%>%
group_by(grupo_edad, year)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()
vars <- c("habloalg", "pidioayuda", "denuncio")
tempo <- data.frame()
for (i in 1:length(vars)) {
group_by(year, escol)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(11:20),c(2,3,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
vars <- c("habloalg", "pidioayuda", "denuncio")
tempo <- data.frame()
for (i in 1:length(vars)) {
data%>%
group_by(year, escol)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(11:20),c(2,3,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
vars <- c("habloalg", "pidioayuda", "denuncio")
tempo <- data.frame()
for (i in 1:length(vars)) {
data%>%
group_by(year, grupo_edad, data[vars[i]])%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(11:20),c(2,3,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
minitempo <- data%>%
group_by(year, grupo_edad, data[vars[1]])%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- data%>%
group_by(year, grupo_edad, data[vars[1]])%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
View(minitempo)
View(minitempo)
minitempo <- data%>%
filter(!is.na(habloalg))%>%
group_by(year, grupo_edad, data[vars[1]])%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%
minitempo <- data%>%
filter(!is.na(habloalg))%>%
group_by(year, grupo_edad, data[vars[1]])%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()
View(data)
View(data)
vars <- c("habloalg", "pidioayuda", "denuncio")
tempo <- data.frame()
minitempo <- filter(data, !is.na(habloalg))
names(Data)
names(data)
minitempo <- filter(data, !is.na(habloalg))%>%
group_by(year, grupo_edad, data[vars[1]])
minitempo <- group_by(year, grupo_edad, data[vars[1]])%>%
summarize(total=sum(fac_muj, na.rm=T))
minitempo <- group_by(data, year, grupo_edad, data[vars[1]])%>%
summarize(total=sum(fac_muj, na.rm=T))
View(minitempo)
View(minitempo)
ungroup()
minitempo <- minitempo[-c(3,6,9,12,15,18,21,24,27,30,33,36,
37,38,39),]
View(minitempo)
minitempo <- group_by(data, year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- group_by(minitempo, year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
View(minitempo)
View(minitempo)
View(tempo)
View(tema)
View(minitempo)
minitempo <- group_by(data, year, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()
View(minitempo)
8433513+9980905
8433513/18414418
9395870/9395870+9395870
9395870/(9395870+9395870)
9395870/(9395870+9199728)
9199728/(9395870+9199728)
9980905/18414418
vars <- c("habloalg", "pidioayuda", "denuncio")
tempo <- data.frame()
for (i in 1:length(vars)) {
minitempo <- group_by(data, year, grupo_edad, data[vars[i]])%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()
minitempo <- minitempo[-c(3,6,9,12,15,18,21,24,27,30,33,36,
37,38,39),]
minitempo <- group_by(minitempo, year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(11:20),c(2,3,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
View(tempo)
minitempo <- group_by(data, year, grupo_edad, data[vars[1]])%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()
View(minitempo)
minitempo <- minitempo[-c(3,6,9,12,15,18,21,24,27,30,33,36,
37,38,39),]
minitempo <- group_by(minitempo, year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
View(minitempo)
View(minitempo)
View(minitempo)
minitempo <- minitempo[c(2,4,6,8,10,12,14,16,18,20,
22,24),c(1,2,6)]
View(minitempo)
vars <- c("habloalg", "pidioayuda", "denuncio")
tempo <- data.frame()
for (i in 1:length(vars)) {
minitempo <- group_by(data, year, grupo_edad, data[vars[i]])%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()
minitempo <- minitempo[-c(3,6,9,12,15,18,21,24,27,30,33,36,
37,38,39),]
minitempo <- group_by(minitempo, year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(2,4,6,8,10,12,14,16,18,20,
22,24),c(1,2,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
View(tempo)
minitempo <- group_by(data, year, grupo_edad, pidioayuda)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()
View(minitempo)
minitempo <- minitempo[-c(3,6,9,12,15,18,21,24,27,30,33,36,
37,38,39),]
minitempo <- group_by(minitempo, year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
View(minitempo)
minitempo <- group_by(data, year,pidioayuda)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
group_by(minitempo, year)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- group_by(data, year,pidioayuda)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
group_by(year)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
View(minitempo)
minitempo <- group_by(data, year,denuncio)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
group_by(year)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
View(tempo)
View(tema)
View(minitempo)
minitempo <- group_by(data, year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
View(minitempo)
data%>%
group_by(data, year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()
data%>%
group_by(year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()
data%>%
group_by(year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()%>%
filter(habloalg=="Sí")%>%
mutate(order=as.numeric(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=grupo_edad, y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber hablado con \n con alguien de la violencia en pareja",
subtitle="Según su escolaridad y el tipo de violencia",
y="", x="", fill="Año")+
coord_flip()+
scale_fill_manual(values=pal)
data%>%
group_by(year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()%>%
filter(habloalg=="Sí")%>%
mutate(order=as.numeric(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber hablado con \n con alguien de la violencia en pareja",
subtitle="Según su escolaridad y el tipo de violencia",
y="", x="", fill="Año")+
coord_flip()+
scale_fill_manual(values=pal)
data%>%
group_by(year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()%>%
filter(habloalg=="Sí")%>%
mutate(order=as.numeric(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber hablado con \n con alguien de la violencia en pareja",
subtitle="Según su escolaridad y el tipo de violencia",
y="", x="", fill="Año")+
coord_flip()+
scale_fill_manual(values=pal)
data%>%
group_by(year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()%>%
filter(habloalg=="Sí")%>%
mutate(order=as.numeric(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber hablado con \n con alguien de la violencia en pareja",
subtitle="Según su escolaridad y el tipo de violencia",
y="", x="", fill="Año de la encuesta", caption=caption2)+
coord_flip()+
scale_fill_manual(values=pal)
#
# Author: Georgina Jimenez
# -----------------------------------------------------------
# endireh2021/output/graficas
#### Paquetería ####
if(!require(pacman)) install.packages("pacman")
pacman::p_load(tidyverse, here, ggplot2, ggalt)
options(scipen=999)
files <- list(endireh11 = here("import-clean/output/endireh2011.rds"),
endireh16 = here("import-clean/output/endireh2016.rds"),
endireh21 = here("import-clean/output/endireh2021.rds"),
pob = here("import-clean/output/pob.rds"))
#### Tema y funciones ####
source(here("descriptives/src/theme.R"))
suma <- function(x) {
x <- ifelse(x>0, 1, 2)
}
sino <- function(x){
x <- case_when(x==1 ~ "Sí",
x==2 ~ "No")
}
endireh16 <- readRDS(files$endireh16)
endireh21 <- readRDS(files$endireh21)%>%
filter(veinteomas==1)
data <- bind_rows(endireh16, endireh21)%>%
mutate(viosexinf=rowSums(.[,41:46], na.rm=T),
viosexinf=sino(suma(viosexinf)))
vars <- c("viopsiinf", "viofisinf", "viosexinf")
tempo <- data.frame()
tempo <- data.frame()
for (i in 1:length(vars)) {
minitempo <- data%>%
group_by(data[vars[i]], year, grupo_edad)%>%
summarize(total=sum(fac_muj))%>%
ungroup()%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(13:24),c(2,3,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
tempo%>%
mutate(vars=gsub("viopsiinf", "Violencia psicológica", vars),
vars=gsub("viofisinf", "Violencia física", vars),
vars=gsub("viosexinf", "Violencia sexual", vars),
order=as.integer(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber vivido violencia antes de los 15 años",
subtitle="Según su edad y el tipo de violencia",
y="", x="", fill="Año", caption=caption2)+
coord_flip()+
facet_wrap(~vars)+
scale_fill_manual(values=pal)
save("violencia-infancia-edades")
endireh16 <- readRDS(files$endireh16)
endireh21 <- readRDS(files$endireh21)
data <- bind_rows(endireh16, endireh21)
data%>%
group_by(year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()%>%
filter(habloalg=="Sí")%>%
mutate(order=as.numeric(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber hablado con \n con alguien de la violencia en pareja",
subtitle="Según su edad",
y="", x="", fill="Año de la encuesta", caption=caption2)+
coord_flip()+
scale_fill_manual(values=pal)
save("hablar-alguien-edad")
#
# Author: Georgina Jimenez
# -----------------------------------------------------------
# endireh2021/output/graficas
#### Paquetería ####
if(!require(pacman)) install.packages("pacman")
pacman::p_load(tidyverse, here, ggplot2, ggalt)
options(scipen=999)
files <- list(endireh11 = here("import-clean/output/endireh2011.rds"),
endireh16 = here("import-clean/output/endireh2016.rds"),
endireh21 = here("import-clean/output/endireh2021.rds"),
pob = here("import-clean/output/pob.rds"))
#### Tema y funciones ####
source(here("descriptives/src/theme.R"))
suma <- function(x) {
x <- ifelse(x>0, 1, 2)
}
sino <- function(x){
x <- case_when(x==1 ~ "Sí",
x==2 ~ "No")
}
tempo <- data.frame()
for (i in 1:length(vars)) {
minitempo <- data%>%
group_by(data[vars[i]], year, grupo_edad)%>%
summarize(total=sum(fac_muj))%>%
ungroup()%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(13:24),c(2,3,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
tempo%>%
mutate(vars=gsub("viopsiinf", "Violencia psicológica", vars),
vars=gsub("viofisinf", "Violencia física", vars),
vars=gsub("viosexinf", "Violencia sexual", vars),
order=as.integer(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber vivido violencia antes de los 15 años",
subtitle="Según su edad y el tipo de violencia",
y="", x="", fill="Año", caption=caption2)+
coord_flip()+
facet_wrap(~vars)+
scale_fill_manual(values=pal)
save("violencia-infancia-edades")
endireh16 <- readRDS(files$endireh16)
endireh21 <- readRDS(files$endireh21)%>%
filter(veinteomas==1)
data <- bind_rows(endireh16, endireh21)%>%
mutate(viosexinf=rowSums(.[,41:46], na.rm=T),
viosexinf=sino(suma(viosexinf)))
tempo <- data.frame()
for (i in 1:length(vars)) {
minitempo <- data%>%
group_by(data[vars[i]], year, grupo_edad)%>%
summarize(total=sum(fac_muj))%>%
ungroup()%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)
minitempo <- minitempo[c(13:24),c(2,3,6)]
minitempo$vars <- vars[i]
tempo <- bind_rows(tempo, minitempo)
}
tempo%>%
mutate(vars=gsub("viopsiinf", "Violencia psicológica", vars),
vars=gsub("viofisinf", "Violencia física", vars),
vars=gsub("viosexinf", "Violencia sexual", vars),
order=as.integer(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber vivido violencia antes de los 15 años",
subtitle="Según su edad y el tipo de violencia",
y="", x="", fill="Año", caption=caption2)+
coord_flip()+
facet_wrap(~vars)+
scale_fill_manual(values=pal)
tempo%>%
mutate(vars=gsub("viopsiinf", "Violencia psicológica", vars),
vars=gsub("viofisinf", "Violencia física", vars),
vars=gsub("viosexinf", "Violencia sexual", vars),
order=as.integer(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber vivido violencia antes de los 15 años",
subtitle="Según su edad y el tipo de violencia",
y="", x="", fill="Año de la encuesta", caption=caption2)+
coord_flip()+
facet_wrap(~vars)+
scale_fill_manual(values=pal)
save("violencia-infancia-edades")
endireh16 <- readRDS(files$endireh16)
endireh21 <- readRDS(files$endireh21)
data <- bind_rows(endireh16, endireh21)
data%>%
group_by(year,grupo_edad, habloalg)%>%
summarize(total=sum(fac_muj, na.rm=T))%>%
ungroup()%>%
filter(!is.na(habloalg))%>%
filter(!is.na(grupo_edad))%>%
group_by(year, grupo_edad)%>%
mutate(den=sum(total, na.rm=T),
per=total/den*100)%>%
ungroup()%>%
filter(habloalg=="Sí")%>%
mutate(order=as.numeric(grupo_edad),
grupo_edad=gsub("15 a 25 años", "25 años o menos", grupo_edad))%>%
ggplot()+
geom_bar(aes(x=reorder(grupo_edad, -order), y=per, fill=as.factor(year)),
stat="identity", position="dodge")+
tema+
labs(title="Porcentaje de mujeres que dicen haber hablado con \n con alguien de la violencia en pareja",
subtitle="Según su edad",
y="", x="", fill="Año de la encuesta", caption=caption2)+
coord_flip()+
scale_fill_manual(values=pal)
save("hablar-alguien-edad")
